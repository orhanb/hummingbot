from unittest import TestCase

from hummingbot.connector.exchange.btcturk.btcturk_order_book import BtcturkOrderBook
from hummingbot.core.data_type.order_book_message import OrderBookMessageType


class BtcturkOrderBookTests(TestCase):

    """
    [431,
        {'AO': [
                {'A': '0.01394686', 'P': '591468'},
                {'A': '0.54552192', 'P': '591469'},
                {'A': '0.01182674', 'P': '592000'},
                {'A': '0.17179163', 'P': '592005'},
                {'A': '0.00845273', 'P': '592116'},
                {'A': '0.15649644', 'P': '592173'},
                {'A': '0.39124111', 'P': '592989'},
                {'A': '0.38739503', 'P': '592990'},
                {'A': '0.4531', 'P': '592999'},
                {'A': '0.0084831', 'P': '593000'},
                {'A': '0.00845273', 'P': '593116'},
                {'A': '0.77103263', 'P': '593462'},
                {'A': '2.35421883', 'P': '593463'},
                {'A': '0.00853429', 'P': '593999'},
                {'A': '0.04225513', 'P': '594000'},
                {'A': '0.00845273', 'P': '594116'},
                {'A': '0.00181386', 'P': '594894'},
                {'A': '0.00464726', 'P': '594922'},
                {'A': '0.43106316', 'P': '595000'},
                {'A': '0.7848', 'P': '595217'},
                {'A': '4.4303', 'P': '595218'},
                {'A': '0.00119853', 'P': '595369'},
                {'A': '0.00054978', 'P': '595374'},
                {'A': '0.00993386', 'P': '595476'},
                {'A': '0.00344901', 'P': '595600'},
                {'A': '0.00345086', 'P': '595970'},
                {'A': '0.00845273', 'P': '596116'},
                {'A': '0.00842417', 'P': '596318'},
                {'A': '0.00032298', 'P': '596676'},
                {'A': '0.01901374', 'P': '596720'},
                {'A': '2.1994', 'P': '596818'},
                {'A': '0.00045185', 'P': '596828'},
                {'A': '0.00016894', 'P': '596866'},
                {'A': '0.00723675', 'P': '596910'},
                {'A': '0.0012', 'P': '596999'},
                {'A': '0.01041766', 'P': '597000'},
                {'A': '0.02463922', 'P': '597022'},
                {'A': '0.001', 'P': '597249'},
                {'A': '0.05613273', 'P': '597347'},
                {'A': '0.001', 'P': '597499'},
                {'A': '0.19428932', 'P': '597500'},
                {'A': '0.001', 'P': '597749'},
                {'A': '0.00028297', 'P': '597828'},
                {'A': '0.00025169', 'P': '597993'},
                {'A': '0.001', 'P': '597999'},
                {'A': '0.09301042', 'P': '598000'},
                {'A': '0.00017052', 'P': '598162'},
                {'A': '0.0169474', 'P': '598168'},
                {'A': '0.001', 'P': '598249'},
                {'A': '0.08163457', 'P': '598445'},
                {'A': '0.00174637', 'P': '598464'},
                {'A': '0.001', 'P': '598499'},
                {'A': '0.00339534', 'P': '598500'},
                {'A': '0.00218741', 'P': '598553'},
                {'A': '0.04', 'P': '598598'},
                {'A': '0.001', 'P': '598749'},
                {'A': '0.0046', 'P': '598998'},
                {'A': '0.04774965', 'P': '598999'},
                {'A': '0.40053837', 'P': '599000'},
                {'A': '0.02559756', 'P': '599100'},
                {'A': '0.00512972', 'P': '599140'},
                {'A': '0.001', 'P': '599249'},
                {'A': '0.00085528', 'P': '599255'},
                {'A': '0.00051942', 'P': '599296'},
                {'A': '0.00470698', 'P': '599382'},
                {'A': '0.00087356', 'P': '599468'},
                {'A': '0.001', 'P': '599499'},
                {'A': '0.00025903', 'P': '599610'},
                {'A': '0.001', 'P': '599749'},
                {'A': '0.00111227', 'P': '599755'},
                {'A': '0.00023', 'P': '599869'},
                {'A': '0.01669844', 'P': '599900'},
                {'A': '0.00032194', 'P': '599950'},
                {'A': '0.00341341', 'P': '599983'},
                {'A': '0.02721231', 'P': '599999'},
                {'A': '0.93745131', 'P': '600000'},
                {'A': '0.01932024', 'P': '600015'},
                {'A': '0.00166787', 'P': '600166'},
                {'A': '0.001', 'P': '600249'},
                {'A': '0.002', 'P': '600255'},
                {'A': '0.00655096', 'P': '600304'},
                {'A': '0.00589842', 'P': '600423'},
                {'A': '0.00171634', 'P': '600494'},
                {'A': '0.001', 'P': '600499'},
                {'A': '0.05598638', 'P': '600500'},
                {'A': '0.00129053', 'P': '600513'},
                {'A': '0.00062338', 'P': '600555'},
                {'A': '0.02755553', 'P': '600661'},
                {'A': '0.00033836', 'P': '600676'},
                {'A': '0.001', 'P': '600749'},
                {'A': '0.00329757', 'P': '600777'},
                {'A': '0.01462368', 'P': '600889'},
                {'A': '0.00051433', 'P': '600902'},
                {'A': '0.01013227', 'P': '600910'},
                {'A': '0.00176705', 'P': '600913'},
                {'A': '0.00067625', 'P': '600988'},
                {'A': '0.00832784', 'P': '600996'},
                {'A': '0.00336501', 'P': '600998'},
                {'A': '0.001', 'P': '600999'},
                {'A': '0.05683104', 'P': '601000'}
            ],
        'BO': [
                {'A': '0.00289257', 'P': '590951'},
                {'A': '0.2', 'P': '590948'},
                {'A': '0.02674451', 'P': '590694'},
                {'A': '0.02', 'P': '590569'},
                {'A': '0.28886161', 'P': '590154'},
                {'A': '0.19113126', 'P': '590055'},
                {'A': '0.16056768', 'P': '590053'},
                {'A': '0.00018625', 'P': '590010'},
                {'A': '0.85036076', 'P': '590003'},
                {'A': '0.03349376', 'P': '590000'},
                {'A': '0.00846904', 'P': '589913'},
                {'A': '0.02213023', 'P': '589499'},
                {'A': '0.0054319', 'P': '589000'},
                {'A': '0.00639326', 'P': '588969'},
                {'A': '0.00133364', 'P': '588030'},
                {'A': '0.00034095', 'P': '588000'},
                {'A': '0.0191', 'P': '587970'},
                {'A': '0.47974492', 'P': '587850'},
                {'A': '0.4531', 'P': '587849'},
                {'A': '0.00594842', 'P': '587803'},
                {'A': '0.001275', 'P': '587500'},
                {'A': '0.154', 'P': '587360'},
                {'A': '0.00034095', 'P': '587000'},
                {'A': '0.0207', 'P': '586780'},
                {'A': '0.000342', 'P': '586659'},
                {'A': '0.00851663', 'P': '586500'},
                {'A': '0.00034095', 'P': '586000'},
                {'A': '0.0209', 'P': '585620'},
                {'A': '0.00853117', 'P': '585500'},
                {'A': '0.09140874', 'P': '585400'},
                {'A': '0.00407295', 'P': '585000'},
                {'A': '0.00173593', 'P': '584800'},
                {'A': '0.55', 'P': '584766'},
                {'A': '4.5313', 'P': '584743'},
                {'A': '0.01721792', 'P': '584500'},
                {'A': '0.00838672', 'P': '584300'},
                {'A': '0.03454082', 'P': '584000'},
                {'A': '0.03190164', 'P': '583900'},
                {'A': '0.01334061', 'P': '583780'},
                {'A': '0.00856041', 'P': '583500'},
                {'A': '0.0029163', 'P': '583252'},
                {'A': '0.00343415', 'P': '583125'},
                {'A': '0.00513718', 'P': '583123'},
                {'A': '0.00162755', 'P': '583115'},
                {'A': '0.0171248', 'P': '583074'},
                {'A': '0.001161270451', 'P': '583052'},
                {'A': '0.00980047', 'P': '583004'},
                {'A': '0.453244984867', 'P': '583000'},
                {'A': '0.01713564', 'P': '582996'},
                {'A': '0.0173086', 'P': '582942'},
                {'A': '0.9504', 'P': '582941'},
                {'A': '2.3089', 'P': '582940'},
                {'A': '0.00017139', 'P': '582854'},
                {'A': '0.00089242', 'P': '582751'},
                {'A': '0.00096608', 'P': '582750'},
                {'A': '0.001', 'P': '582501'},
                {'A': '0.00339864', 'P': '582500'},
                {'A': '0.00804467', 'P': '582288'},
                {'A': '0.001', 'P': '582251'},
                {'A': '0.001', 'P': '582001'},
                {'A': '0.08448383', 'P': '582000'},
                {'A': '0.00559152', 'P': '581907'},
                {'A': '0.001', 'P': '581751'},
                {'A': '0.001', 'P': '581501'},
                {'A': '0.00022679', 'P': '581431'},
                {'A': '0.001', 'P': '581251'},
                {'A': '0.00136242', 'P': '581004'},
                {'A': '0.03406647', 'P': '581003'},
                {'A': '0.001', 'P': '581001'},
                {'A': '0.006595', 'P': '581000'},
                {'A': '0.0030711', 'P': '580955'},
                {'A': '0.03473755', 'P': '580951'},
                {'A': '0.00068803', 'P': '580787'},
                {'A': '0.001', 'P': '580751'},
                {'A': '0.00172027', 'P': '580722'},
                {'A': '0.06156835', 'P': '580666'},
                {'A': '0.00172052', 'P': '580637'},
                {'A': '0.02272075', 'P': '580606'},
                {'A': '0.00159229', 'P': '580506'},
                {'A': '0.001', 'P': '580501'},
                {'A': '0.00172304', 'P': '580369'},
                {'A': '0.001', 'P': '580251'},
                {'A': '0.0172213', 'P': '580096'},
                {'A': '0.00019265', 'P': '580008'},
                {'A': '0.00861198', 'P': '580006'},
                {'A': '0.001', 'P': '580001'},
                {'A': '4.32073407', 'P': '580000'},
                {'A': '0.02584122', 'P': '579888'},
                {'A': '0.001', 'P': '579751'},
                {'A': '0.02527668', 'P': '579634'},
                {'A': '0.001', 'P': '579501'},
                {'A': '0.02632634', 'P': '579334'},
                {'A': '0.001', 'P': '579251'},
                {'A': '0.00172509', 'P': '579100'},
                {'A': '0.00025166', 'P': '579093'},
                {'A': '0.00862686', 'P': '579006'},
                {'A': '0.001', 'P': '579001'},
                {'A': '0.00034567', 'P': '579000'},
                {'A': '0.00120953', 'P': '578981'},
                {'A': '0.01741599', 'P': '578942'}
                ],
        'CS': 6905470,
        'PS': 'BTCTRY',
        'channel': 'orderbook',
        'event': 'BTCTRY',
        'type': 431}]
    """
    """[991, {'current': '5.1.0', 'min': '2.3.0', 'type': 991}]
[100, {'message': 'join|obdiff:BTCTRY', 'ok': True, 'type': 100}]
[431,
 {'AO': [{'A': '0.03193427172', 'P': '595000'},
         {'A': '0.00420446', 'P': '595200'},
         {'A': '0.03196689', 'P': '595350'},
         {'A': '0.00119853', 'P': '595369'},
         {'A': '0.00054978', 'P': '595374'},
         {'A': '0.00386793', 'P': '595497'},
         {'A': '0.0257793', 'P': '595500'},
         {'A': '0.01015699', 'P': '595572'},
         {'A': '0.00344901', 'P': '595600'},
         {'A': '0.00841603', 'P': '595698'},
         {'A': '0.00345086', 'P': '595970'},
         {'A': '0.12249069', 'P': '596000'},
         {'A': '0.00845273', 'P': '596116'},
         {'A': '0.02', 'P': '596169'},
         {'A': '0.00842417', 'P': '596318'},
         {'A': '0.01725511', 'P': '596676'},
         {'A': '0.01901374', 'P': '596720'},
         {'A': '0.00016773', 'P': '596777'},
         {'A': '0.00045185', 'P': '596828'},
         {'A': '0.00016894', 'P': '596866'},
         {'A': '0.38871225', 'P': '596900'},
         {'A': '0.00723675', 'P': '596910'},
         {'A': '0.0012', 'P': '596999'},
         {'A': '0.01041766', 'P': '597000'},
         {'A': '0.02463922', 'P': '597022'},
         {'A': '0.001', 'P': '597249'},
         {'A': '0.39254245', 'P': '597346'},
         {'A': '0.05613273', 'P': '597347'},
         {'A': '0.001', 'P': '597499'},
         {'A': '0.19428932', 'P': '597500'},
         {'A': '0.001', 'P': '597749'},
         {'A': '0.00028297', 'P': '597828'},
         {'A': '0.00025169', 'P': '597993'},
         {'A': '0.001', 'P': '597999'},
         {'A': '0.09301042', 'P': '598000'},
         {'A': '0.4531', 'P': '598102'},
         {'A': '0.00017052', 'P': '598162'},
         {'A': '0.0169474', 'P': '598168'},
         {'A': '0.001', 'P': '598249'},
         {'A': '0.0033839', 'P': '598250'},
         {'A': '0.00334009', 'P': '598445'},
         {'A': '0.00174637', 'P': '598464'},
         {'A': '0.001', 'P': '598499'},
         {'A': '0.00339534', 'P': '598500'},
         {'A': '0.00218741', 'P': '598553'},
         {'A': '0.04', 'P': '598598'},
         {'A': '0.00336637', 'P': '598645'},
         {'A': '0.001', 'P': '598749'},
         {'A': '0.0046', 'P': '598998'},
         {'A': '0.00601336', 'P': '598999'},
         {'A': '0.39966742', 'P': '599000'},
         {'A': '0.02559756', 'P': '599100'},
         {'A': '0.00512972', 'P': '599140'},
         {'A': '0.001', 'P': '599249'},
         {'A': '0.00085528', 'P': '599255'},
         {'A': '0.00051942', 'P': '599296'},
         {'A': '0.00470698', 'P': '599382'},
         {'A': '0.00087356', 'P': '599468'},
         {'A': '0.001', 'P': '599499'},
         {'A': '0.8154', 'P': '599503'},
         {'A': '4.4303', 'P': '599504'},
         {'A': '0.00025903', 'P': '599610'},
         {'A': '0.00503056', 'P': '599717'},
         {'A': '0.001', 'P': '599749'},
         {'A': '0.00111227', 'P': '599755'},
         {'A': '0.00023', 'P': '599869'},
         {'A': '0.00032194', 'P': '599950'},
         {'A': '0.00341341', 'P': '599983'},
         {'A': '0.02962558', 'P': '599999'},
         {'A': '0.96470741', 'P': '600000'},
         {'A': '0.01932024', 'P': '600015'},
         {'A': '0.00166787', 'P': '600166'},
         {'A': '0.001', 'P': '600249'},
         {'A': '0.002', 'P': '600255'},
         {'A': '0.00655096', 'P': '600304'},
         {'A': '0.00589842', 'P': '600423'},
         {'A': '0.00171634', 'P': '600494'},
         {'A': '0.001', 'P': '600499'},
         {'A': '0.05598638', 'P': '600500'},
         {'A': '0.00129053', 'P': '600513'},
         {'A': '0.00062338', 'P': '600555'},
         {'A': '0.02755553', 'P': '600661'},
         {'A': '0.00033836', 'P': '600676'},
         {'A': '0.0025149', 'P': '600715'},
         {'A': '0.001', 'P': '600749'},
         {'A': '0.00329757', 'P': '600777'},
         {'A': '0.01462368', 'P': '600889'},
         {'A': '0.00051433', 'P': '600902'},
         {'A': '0.01013227', 'P': '600910'},
         {'A': '0.00176705', 'P': '600913'},
         {'A': '0.00067625', 'P': '600988'},
         {'A': '0.00832784', 'P': '600996'},
         {'A': '0.00336501', 'P': '600998'},
         {'A': '0.001', 'P': '600999'},
         {'A': '0.05683104', 'P': '601000'},
         {'A': '0.00832518', 'P': '601188'},
         {'A': '0.00053629', 'P': '601230'},
         {'A': '0.001', 'P': '601249'},
         {'A': '0.05083219', 'P': '601340'},
         {'A': '0.00066264', 'P': '601382'}],
  'BO': [{'A': '0.000249498098', 'P': '594935'},
         {'A': '0.26639093', 'P': '594933'},
         {'A': '0.01620816', 'P': '594894'},
         {'A': '0.00298049', 'P': '594803'},
         {'A': '0.55466785', 'P': '594660'},
         {'A': '0.02', 'P': '594528'},
         {'A': '0.1968578', 'P': '594491'},
         {'A': '0.07329', 'P': '594490'},
         {'A': '0.4531', 'P': '594256'},
         {'A': '0.00840778', 'P': '594211'},
         {'A': '1.42331995', 'P': '593672'},
         {'A': '7.21685243', 'P': '593671'},
         {'A': '0.0261', 'P': '593670'},
         {'A': '0.0663', 'P': '593530'},
         {'A': '0.00536788', 'P': '593493'},
         {'A': '0.00084131', 'P': '593242'},
         {'A': '0.02239607', 'P': '593001'},
         {'A': '0.00120615', 'P': '593000'},
         {'A': '3.17755169', 'P': '592899'},
         {'A': '0.00016866', 'P': '592295'},
         {'A': '0.00118044', 'P': '592000'},
         {'A': '0.0212', 'P': '591900'},
         {'A': '0.00168803', 'P': '591814'},
         {'A': '0.00084155', 'P': '591545'},
         {'A': '0.01063242', 'P': '591000'},
         {'A': '0.00046623', 'P': '590912'},
         {'A': '0.930501', 'P': '590658'},
         {'A': '4.5313', 'P': '590657'},
         {'A': '0.00084155', 'P': '590545'},
         {'A': '0.0204', 'P': '590410'},
         {'A': '0.03213918', 'P': '590400'},
         {'A': '0.00126909', 'P': '590380'},
         {'A': '0.0084618', 'P': '590300'},
         {'A': '0.00846534', 'P': '590053'},
         {'A': '0.05753249', 'P': '590030'},
         {'A': '0.00338367', 'P': '590011'},
         {'A': '0.00018625', 'P': '590010'},
         {'A': '0.00185089', 'P': '590002'},
         {'A': '0.24231232', 'P': '590000'},
         {'A': '0.00847468', 'P': '589403'},
         {'A': '0.00203903', 'P': '589000'},
         {'A': '0.00848052', 'P': '588997'},
         {'A': '0.00639326', 'P': '588969'},
         {'A': '0.00849061', 'P': '588297'},
         {'A': '0.05582827', 'P': '588000'},
         {'A': '0.00594842', 'P': '587803'},
         {'A': '0.01274892', 'P': '587697'},
         {'A': '0.001275', 'P': '587500'},
         {'A': '0.00850507', 'P': '587297'},
         {'A': '2.3089', 'P': '587164'},
         {'A': '0.00034095', 'P': '587000'},
         {'A': '0.01277065', 'P': '586697'},
         {'A': '0.000342', 'P': '586659'},
         {'A': '0.00851663', 'P': '586500'},
         {'A': '0.00034095', 'P': '586000'},
         {'A': '0.04266218', 'P': '585999'},
         {'A': '0.00853117', 'P': '585500'},
         {'A': '0.09140874', 'P': '585400'},
         {'A': '0.02997013', 'P': '585000'},
         {'A': '0.00173593', 'P': '584800'},
         {'A': '0.01721792', 'P': '584500'},
         {'A': '0.00838672', 'P': '584300'},
         {'A': '0.03454082', 'P': '584000'},
         {'A': '0.03190164', 'P': '583900'},
         {'A': '0.01334061', 'P': '583780'},
         {'A': '0.00856041', 'P': '583500'},
         {'A': '0.0029163', 'P': '583252'},
         {'A': '0.00343415', 'P': '583125'},
         {'A': '0.00162755', 'P': '583115'},
         {'A': '0.0171248', 'P': '583074'},
         {'A': '0.001161270451', 'P': '583052'},
         {'A': '0.00980047', 'P': '583004'},
         {'A': '0.4593672', 'P': '583000'},
         {'A': '0.01713564', 'P': '582996'},
         {'A': '0.0173086', 'P': '582942'},
         {'A': '0.00017139', 'P': '582854'},
         {'A': '0.00089242', 'P': '582751'},
         {'A': '0.00096608', 'P': '582750'},
         {'A': '0.001', 'P': '582501'},
         {'A': '0.00339864', 'P': '582500'},
         {'A': '0.00804467', 'P': '582288'},
         {'A': '0.001', 'P': '582251'},
         {'A': '0.001', 'P': '582001'},
         {'A': '0.08448383', 'P': '582000'},
         {'A': '0.00559152', 'P': '581907'},
         {'A': '0.001', 'P': '581751'},
         {'A': '0.001', 'P': '581501'},
         {'A': '0.00022679', 'P': '581431'},
         {'A': '0.001', 'P': '581251'},
         {'A': '0.0345053', 'P': '581241'},
         {'A': '0.00136242', 'P': '581004'},
         {'A': '0.03406647', 'P': '581003'},
         {'A': '0.001', 'P': '581001'},
         {'A': '0.006595', 'P': '581000'},
         {'A': '0.0030711', 'P': '580955'},
         {'A': '0.03473755', 'P': '580951'},
         {'A': '0.00068803', 'P': '580787'},
         {'A': '0.001', 'P': '580751'},
         {'A': '0.00172027', 'P': '580722'},
         {'A': '0.06156835', 'P': '580666'}],
  'CS': 6906955,
  'PS': 'BTCTRY',
  'channel': 'obdiff',
  'event': 'BTCTRY',
  'type': 431}]
[432,
 {'AO': [{'A': '0.15801698', 'CP': 0, 'P': '600499'}],
  'BO': [{'A': '0.19684722', 'CP': 1, 'P': '594529'},
         {'A': '0.1968578', 'CP': 3, 'P': '594491'}],
  'CS': 6906954,
  'PS': 'BTCTRY',
  'channel': 'obdiff',
  'event': 'BTCTRY',
  'type': 432}]
"""

    def test_snapshot_message_from_exchange(self):
        snapshot_message = BtcturkOrderBook.snapshot_message_from_exchange(
            msg={'CS': 7273984, 'PS': 'AVAXUSDT', 'AO': [{'A': '468.419', 'P': '67.41'}, {'A': '301.355', 'P': '67.62'}, {'A': '97.2', 'P': '67.63'}, {'A': '65', 'P': '67.68'}, {'A': '2', 'P': '67.88'}, {'A': '964.1', 'P': '67.95'}, {'A': '8.129', 'P': '68.2'}, {'A': '305.1', 'P': '68.22'}, {'A': '14.914', 'P': '68.25'}, {'A': '7.324', 'P': '68.3'}, {'A': '2.153', 'P': '68.78'}, {'A': '2.943', 'P': '68.95'}, {'A': '599.451', 'P': '68.98'}, {'A': '0.999', 'P': '69'}, {'A': '99.23', 'P': '69.41'}, {'A': '0.504', 'P': '69.75'}, {'A': '8', 'P': '69.81'}, {'A': '5', 'P': '69.9'}, {'A': '5', 'P': '69.95'}, {'A': '6.122', 'P': '69.99'}, {'A': '43.214', 'P': '70'}, {'A': '1.796', 'P': '70.01'}, {'A': '5', 'P': '70.1'}, {'A': '2', 'P': '70.17'}, {'A': '5', 'P': '70.23'}, {'A': '49', 'P': '70.32'}, {'A': '5', 'P': '70.35'}, {'A': '5', 'P': '70.39'}, {'A': '5', 'P': '70.45'}, {'A': '0.242', 'P': '70.48'}, {'A': '38.652', 'P': '70.5'}, {'A': '5', 'P': '70.51'}, {'A': '5', 'P': '70.58'}, {'A': '1.5', 'P': '70.6'}, {'A': '5', 'P': '70.65'}, {'A': '5', 'P': '70.7'}, {'A': '5', 'P': '70.75'}, {'A': '6.5', 'P': '70.8'}, {'A': '5', 'P': '70.83'}, {'A': '5', 'P': '70.85'}, {'A': '0.5', 'P': '70.86'}, {'A': '6.5', 'P': '70.9'}, {'A': '36.26', 'P': '70.93'}, {'A': '5', 'P': '70.95'}, {'A': '5', 'P': '70.96'}, {'A': '5', 'P': '70.98'}, {'A': '5', 'P': '70.99'}, {'A': '207.378', 'P': '71'}, {'A': '0.665', 'P': '71.02'}, {'A': '1.5', 'P': '71.1'}, {'A': '2.231', 'P': '71.2'}, {'A': '0.745', 'P': '71.23'}, {'A': '14.223', 'P': '71.25'}, {'A': '53.349', 'P': '71.3'}, {'A': '10.615', 'P': '71.35'}, {'A': '14.59', 'P': '71.38'}, {'A': '4.697', 'P': '71.4'}, {'A': '0.334', 'P': '71.43'}, {'A': '7.146', 'P': '71.45'}, {'A': '6.75', 'P': '71.49'}, {'A': '43.197', 'P': '71.5'}, {'A': '48.684', 'P': '71.55'}, {'A': '0.4', 'P': '71.59'}, {'A': '1.5', 'P': '71.6'}, {'A': '6.234', 'P': '71.66'}, {'A': '8.476', 'P': '71.7'}, {'A': '0.584', 'P': '71.71'}, {'A': '0.4', 'P': '71.74'}, {'A': '0.139', 'P': '71.79'}, {'A': '7', 'P': '71.8'}, {'A': '20.723', 'P': '71.81'}, {'A': '9.888', 'P': '71.82'}, {'A': '0.364', 'P': '71.83'}, {'A': '2.3', 'P': '71.9'}, {'A': '7.936', 'P': '71.99'}, {'A': '366.414', 'P': '72'}, {'A': '2.75', 'P': '72.04'}, {'A': '66.838', 'P': '72.05'}, {'A': '1.919', 'P': '72.06'}, {'A': '2.077', 'P': '72.08'}, {'A': '1.5', 'P': '72.1'}, {'A': '1.5', 'P': '72.2'}, {'A': '41.196', 'P': '72.25'}, {'A': '1.5', 'P': '72.3'}, {'A': '2.147', 'P': '72.4'}, {'A': '15.793', 'P': '72.41'}, {'A': '84.016', 'P': '72.5'}, {'A': '37.5', 'P': '72.6'}, {'A': '1.5', 'P': '72.7'}, {'A': '1.321', 'P': '72.71'}, {'A': '0.139', 'P': '72.79'}, {'A': '5.228', 'P': '72.8'}, {'A': '1.646', 'P': '72.9'}, {'A': '0.991', 'P': '72.91'}, {'A': '0.481', 'P': '72.92'}, {'A': '11.125', 'P': '72.99'}, {'A': '263.716', 'P': '73'}, {'A': '7.017', 'P': '73.01'}, {'A': '2', 'P': '73.07'}, {'A': '5.912', 'P': '73.1'}], 'BO': [{'A': '2.5', 'P': '67.28'}, {'A': '6', 'P': '67.23'}, {'A': '44.876', 'P': '67.22'}, {'A': '23.36', 'P': '67.2'}, {'A': '148.974', 'P': '67.19'}, {'A': '79.193', 'P': '67.15'}, {'A': '7.151', 'P': '67.14'}, {'A': '476.687', 'P': '67.13'}, {'A': '17.9', 'P': '67.12'}, {'A': '13.716', 'P': '67.1'}, {'A': '1', 'P': '67.09'}, {'A': '14.256', 'P': '67.08'}, {'A': '97.7', 'P': '67.07'}, {'A': '1.982', 'P': '67.06'}, {'A': '0.5', 'P': '67.05'}, {'A': '8.219', 'P': '67.03'}, {'A': '796.21', 'P': '67'}, {'A': '2.193', 'P': '66.97'}, {'A': '0.149', 'P': '66.92'}, {'A': '0.149', 'P': '66.85'}, {'A': '0.149', 'P': '66.84'}, {'A': '4.581', 'P': '66.83'}, {'A': '974.206', 'P': '66.82'}, {'A': '1.187', 'P': '66.76'}, {'A': '3.199787439066', 'P': '66.75'}, {'A': '5.258', 'P': '66.7'}, {'A': '0.377', 'P': '66.67'}, {'A': '69.114', 'P': '66.66'}, {'A': '0.299', 'P': '66.65'}, {'A': '0.515', 'P': '66.64'}, {'A': '1.65', 'P': '66.62'}, {'A': '7.493', 'P': '66.6'}, {'A': '4.356', 'P': '66.54'}, {'A': '166.601', 'P': '66.51'}, {'A': '36.266', 'P': '66.5'}, {'A': '0.375', 'P': '66.49'}, {'A': '3.006', 'P': '66.48'}, {'A': '0.665', 'P': '66.45'}, {'A': '2.15', 'P': '66.43'}, {'A': '3.838', 'P': '66.41'}, {'A': '492.733', 'P': '66.4'}, {'A': '0.393', 'P': '66.39'}, {'A': '50', 'P': '66.36'}, {'A': '0.15', 'P': '66.33'}, {'A': '0.15', 'P': '66.32'}, {'A': '8.7', 'P': '66.31'}, {'A': '8.532', 'P': '66.3'}, {'A': '10.35', 'P': '66.25'}, {'A': '7.084', 'P': '66.2'}, {'A': '3', 'P': '66.15'}, {'A': '1.662', 'P': '66.14'}, {'A': '3.031', 'P': '66.1'}, {'A': '0.16', 'P': '66.05'}, {'A': '2.029', 'P': '66.03'}, {'A': '3.574', 'P': '66.02'}, {'A': '3.521', 'P': '66.01'}, {'A': '471.937', 'P': '66'}, {'A': '4.18', 'P': '65.99'}, {'A': '0.499', 'P': '65.97'}, {'A': '2', 'P': '65.95'}, {'A': '0.21', 'P': '65.91'}, {'A': '21.5', 'P': '65.9'}, {'A': '1', 'P': '65.89'}, {'A': '0.476', 'P': '65.87'}, {'A': '1.52', 'P': '65.84'}, {'A': '0.163', 'P': '65.83'}, {'A': '4.944', 'P': '65.8'}, {'A': '0.296', 'P': '65.78'}, {'A': '3.877', 'P': '65.75'}, {'A': '0.5', 'P': '65.74'}, {'A': '197.4', 'P': '65.73'}, {'A': '2.184', 'P': '65.7'}, {'A': '0.504', 'P': '65.65'}, {'A': '10.474', 'P': '65.6'}, {'A': '10.716', 'P': '65.55'}, {'A': '1.051', 'P': '65.53'}, {'A': '79.05', 'P': '65.5'}, {'A': '0.57', 'P': '65.49'}, {'A': '4.58', 'P': '65.46'}, {'A': '1.652', 'P': '65.4'}, {'A': '0.229', 'P': '65.37'}, {'A': '1.994', 'P': '65.35'}, {'A': '0.229', 'P': '65.34'}, {'A': '4.851', 'P': '65.31'}, {'A': '9.493', 'P': '65.3'}, {'A': '0.775', 'P': '65.29'}, {'A': '0.2', 'P': '65.25'}, {'A': '41.46', 'P': '65.2'}, {'A': '2', 'P': '65.19'}, {'A': '1.534', 'P': '65.13'}, {'A': '3.069', 'P': '65.12'}, {'A': '155.569', 'P': '65.1'}, {'A': '0.153', 'P': '65.09'}, {'A': '100.396', 'P': '65.08'}, {'A': '4.606', 'P': '65.07'}, {'A': '3.697', 'P': '65.06'}, {'A': '5.639', 'P': '65.05'}, {'A': '0.768', 'P': '65.04'}, {'A': '30.715', 'P': '65.03'}, {'A': '70.906', 'P': '65.02'}], 'channel': 'orderbook', 'event': 'AVAXUSDT', 'type': 431},
            timestamp=1640000000.0,
            metadata={"trading_pair": "AVAXUSDT"}
        )

        self.assertEqual("AVAXUSDT", snapshot_message.trading_pair)
        self.assertEqual(OrderBookMessageType.SNAPSHOT, snapshot_message.type)
        self.assertEqual(1640000000.0, snapshot_message.timestamp)
        self.assertEqual(1, snapshot_message.update_id)
        self.assertEqual(-1, snapshot_message.trade_id)
        self.assertEqual(1, len(snapshot_message.bids))
        self.assertEqual(4.0, snapshot_message.bids[0].price)
        self.assertEqual(431.0, snapshot_message.bids[0].amount)
        self.assertEqual(1, snapshot_message.bids[0].update_id)
        self.assertEqual(1, len(snapshot_message.asks))
        self.assertEqual(4.000002, snapshot_message.asks[0].price)
        self.assertEqual(12.0, snapshot_message.asks[0].amount)
        self.assertEqual(1, snapshot_message.asks[0].update_id)

    def test_diff_message_from_exchange(self):
        """[432,
        {'AO': [],
        'BO': [{'A': '0.038', 'CP': 1, 'P': '594936'},
                {'A': '0.01659254', 'CP': 0, 'P': '594894'},
                {'A': '0.06156835', 'CP': 3, 'P': '580666'}],
        'CS': 6906955,
        'PS': 'BTCTRY',
        'channel': 'obdiff',
        'event': 'BTCTRY',
        'type': 432}]"""

        diff_msg = BtcturkOrderBook.diff_message_from_exchange(
            msg={
                "e": "depthUpdate",
                "E": 123456789,
                "s": "COINALPHAHBOT",
                "U": 1,
                "u": 2,
                "b": [
                    [
                        "0.0024",
                        "10"
                    ]
                ],
                "a": [
                    [
                        "0.0026",
                        "100"
                    ]
                ]
            },
            timestamp=1640000000.0,
            metadata={"trading_pair": "COINALPHA-HBOT"}
        )

        self.assertEqual("COINALPHA-HBOT", diff_msg.trading_pair)
        self.assertEqual(OrderBookMessageType.DIFF, diff_msg.type)
        self.assertEqual(1640000000.0, diff_msg.timestamp)
        self.assertEqual(2, diff_msg.update_id)
        self.assertEqual(1, diff_msg.first_update_id)
        self.assertEqual(-1, diff_msg.trade_id)
        self.assertEqual(1, len(diff_msg.bids))
        self.assertEqual(0.0024, diff_msg.bids[0].price)
        self.assertEqual(10.0, diff_msg.bids[0].amount)
        self.assertEqual(2, diff_msg.bids[0].update_id)
        self.assertEqual(1, len(diff_msg.asks))
        self.assertEqual(0.0026, diff_msg.asks[0].price)
        self.assertEqual(100.0, diff_msg.asks[0].amount)
        self.assertEqual(2, diff_msg.asks[0].update_id)

    def test_trade_message_from_exchange(self):
        # 421 for recent trades
        # 422 for trades. API keeps sending 421, send 422 in case of trade
        '''[991, {'current': '5.1.0', 'min': '2.3.0', 'type': 991}]
        [100, {'message': 'join|trade:AVAXUSDT', 'ok': True, 'type': 100}]
        [421,
        {'channel': 'trade',
        'event': 'AVAXUSDT',
        'items': [{'A': '13.2630000000',
                    'D': '1647000805483',
                    'I': '110163781755762125',
                    'P': '76.5900000000',
                    'S': 0},
                    {'A': '3.7147661242',
                    'D': '1647000787783',
                    'I': '110163781755762124',
                    'P': '76.5900000000',
                    'S': 0},
                    {'A': '1.4220000000',
                    'D': '1647000779134',
                    'I': '110163781755762123',
                    'P': '76.5900000000',
                    'S': 0},
                    {'A': '0.3980000000',
                    'D': '1647000779134',
                    'I': '110163781755762122',
                    'P': '76.5800000000',
                    'S': 0},
                    {'A': '0.3980000000',
                    'D': '1647000752604',
                    'I': '110163781755762121',
                    'P': '76.5200000000',
                    'S': 1},
                    {'A': '4.3420000000',
                    'D': '1647000736635',
                    'I': '110163781755762120',
                    'P': '76.7000000000',
                    'S': 1},
                    {'A': '1.0230000000',
                    'D': '1647000722276',
                    'I': '110163781755762119',
                    'P': '76.7000000000',
                    'S': 1},
                    {'A': '29.2110000000',
                    'D': '1647000717267',
                    'I': '110163781755762118',
                    'P': '76.7800000000',
                    'S': 0},
                    {'A': '1.1120000000',
                    'D': '1647000717267',
                    'I': '110163781755762117',
                    'P': '76.7700000000',
                    'S': 0},
                    {'A': '0.6100000000',
                    'D': '1647000717267',
                    'I': '110163781755762116',
                    'P': '76.7700000000',
                    'S': 0},
                    {'A': '0.7900000000',
                    'D': '1647000698542',
                    'I': '110163781755762115',
                    'P': '76.7000000000',
                    'S': 0},
                    {'A': '1.1120000000',
                    'D': '1647000692670',
                    'I': '110163781755762114',
                    'P': '76.6900000000',
                    'S': 1},
                    {'A': '0.2880000000',
                    'D': '1647000692670',
                    'I': '110163781755762113',
                    'P': '76.6900000000',
                    'S': 1},
                    {'A': '1.4000000000',
                    'D': '1647000691575',
                    'I': '110163781755762112',
                    'P': '76.6900000000',
                    'S': 1},
                    {'A': '0.6100000000',
                    'D': '1647000687258',
                    'I': '110163781755762111',
                    'P': '76.7000000000',
                    'S': 1},
                    {'A': '1.5220000000',
                    'D': '1647000683927',
                    'I': '110163781755762110',
                    'P': '76.7900000000',
                    'S': 0},
                    {'A': '0.1479137526',
                    'D': '1647000676243',
                    'I': '110163781755762109',
                    'P': '76.8000000000',
                    'S': 0},
                    {'A': '6.8118144120',
                    'D': '1647000658838',
                    'I': '110163781755762108',
                    'P': '76.7900000000',
                    'S': 0},
                    {'A': '0.6758317902',
                    'D': '1647000652206',
                    'I': '110163781755762107',
                    'P': '76.8000000000',
                    'S': 0},
                    {'A': '1.9050000000',
                    'D': '1647000652206',
                    'I': '110163781755762106',
                    'P': '76.7600000000',
                    'S': 0},
                    {'A': '13.0294836890',
                    'D': '1647000635442',
                    'I': '110163781755762105',
                    'P': '76.6800000000',
                    'S': 0},
                    {'A': '4.0310000000',
                    'D': '1647000617276',
                    'I': '110163781755762104',
                    'P': '76.6900000000',
                    'S': 0},
                    {'A': '0.6490000000',
                    'D': '1647000617276',
                    'I': '110163781755762103',
                    'P': '76.6400000000',
                    'S': 0},
                    {'A': '0.2300000000',
                    'D': '1647000617276',
                    'I': '110163781755762102',
                    'P': '76.6100000000',
                    'S': 0},
                    {'A': '8.9211864350',
                    'D': '1647000607046',
                    'I': '110163781755762101',
                    'P': '76.6000000000',
                    'S': 1},
                    {'A': '4.7430000000',
                    'D': '1647000604304',
                    'I': '110163781755762100',
                    'P': '76.6000000000',
                    'S': 1},
                    {'A': '20.2258135650',
                    'D': '1647000592207',
                    'I': '110163781755762099',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '15.6691864350',
                    'D': '1647000563732',
                    'I': '110163781755762098',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '5.6740000000',
                    'D': '1647000563732',
                    'I': '110163781755762097',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '36.3078135650',
                    'D': '1647000563732',
                    'I': '110163781755762096',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '13.0430915049',
                    'D': '1647000530801',
                    'I': '110163781755762095',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '1.3000000000',
                    'D': '1647000502380',
                    'I': '110163781755762094',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '1.0427951658',
                    'D': '1647000488234',
                    'I': '110163781755762093',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '0.6472628686',
                    'D': '1647000440347',
                    'I': '110163781755762092',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '0.6860000000',
                    'D': '1647000440159',
                    'I': '110163781755762091',
                    'P': '76.4600000000',
                    'S': 1},
                    {'A': '5.7120000000',
                    'D': '1647000438093',
                    'I': '110163781755762090',
                    'P': '76.4000000000',
                    'S': 0},
                    {'A': '12.6370000000',
                    'D': '1647000437198',
                    'I': '110163781755762089',
                    'P': '76.3800000000',
                    'S': 0},
                    {'A': '0.5000000000',
                    'D': '1647000436516',
                    'I': '110163781755762088',
                    'P': '76.3700000000',
                    'S': 0},
                    {'A': '0.5000000000',
                    'D': '1647000428191',
                    'I': '110163781755762087',
                    'P': '76.2700000000',
                    'S': 1},
                    {'A': '2.0530000000',
                    'D': '1647000416314',
                    'I': '110163781755762086',
                    'P': '76.2600000000',
                    'S': 1},
                    {'A': '1.1900000000',
                    'D': '1647000415283',
                    'I': '110163781755762085',
                    'P': '76.3000000000',
                    'S': 0},
                    {'A': '39.2830000000',
                    'D': '1647000415283',
                    'I': '110163781755762084',
                    'P': '76.2900000000',
                    'S': 0},
                    {'A': '39.2830000000',
                    'D': '1647000405274',
                    'I': '110163781755762083',
                    'P': '76.2200000000',
                    'S': 0},
                    {'A': '0.8100000000',
                    'D': '1647000404137',
                    'I': '110163781755762082',
                    'P': '76.2100000000',
                    'S': 1},
                    {'A': '1.1900000000',
                    'D': '1647000404137',
                    'I': '110163781755762081',
                    'P': '76.2200000000',
                    'S': 1},
                    {'A': '1.0000000000',
                    'D': '1647000392549',
                    'I': '110163781755762080',
                    'P': '76.2000000000',
                    'S': 1},
                    {'A': '39.7500000000',
                    'D': '1647000319101',
                    'I': '110163781755762079',
                    'P': '76.2500000000',
                    'S': 1},
                    {'A': '0.7060000000',
                    'D': '1647000318677',
                    'I': '110163781755762078',
                    'P': '76.2500000000',
                    'S': 1},
                    {'A': '17.0980000000',
                    'D': '1647000311396',
                    'I': '110163781755762077',
                    'P': '76.2400000000',
                    'S': 1},
                    {'A': '0.6160000000',
                    'D': '1647000303913',
                    'I': '110163781755762076',
                    'P': '76.2500000000',
                    'S': 1},
                    {'A': '12.6370000000',
                    'D': '1647000303913',
                    'I': '110163781755762075',
                    'P': '76.2700000000',
                    'S': 1},
                    {'A': '0.6540000000',
                    'D': '1647000279134',
                    'I': '110163781755762074',
                    'P': '76.3500000000',
                    'S': 1},
                    {'A': '0.2096024805',
                    'D': '1647000258568',
                    'I': '110163781755762073',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '0.2194344153',
                    'D': '1647000194305',
                    'I': '110163781755762072',
                    'P': '76.6000000000',
                    'S': 0}],
        'symbol': 'AVAXUSDT',
        'type': 421}]
        [421,
        {'channel': 'trade',
        'event': 'AVAXUSDT',
        'items': [{'A': '13.2630000000',
                    'D': '1647000805483',
                    'I': '110163781755762125',
                    'P': '76.5900000000',
                    'S': 0},
                    {'A': '3.7147661242',
                    'D': '1647000787783',
                    'I': '110163781755762124',
                    'P': '76.5900000000',
                    'S': 0},
                    {'A': '1.4220000000',
                    'D': '1647000779134',
                    'I': '110163781755762123',
                    'P': '76.5900000000',
                    'S': 0},
                    {'A': '0.3980000000',
                    'D': '1647000779134',
                    'I': '110163781755762122',
                    'P': '76.5800000000',
                    'S': 0},
                    {'A': '0.3980000000',
                    'D': '1647000752604',
                    'I': '110163781755762121',
                    'P': '76.5200000000',
                    'S': 1},
                    {'A': '4.3420000000',
                    'D': '1647000736635',
                    'I': '110163781755762120',
                    'P': '76.7000000000',
                    'S': 1},
                    {'A': '1.0230000000',
                    'D': '1647000722276',
                    'I': '110163781755762119',
                    'P': '76.7000000000',
                    'S': 1},
                    {'A': '29.2110000000',
                    'D': '1647000717267',
                    'I': '110163781755762118',
                    'P': '76.7800000000',
                    'S': 0},
                    {'A': '1.1120000000',
                    'D': '1647000717267',
                    'I': '110163781755762117',
                    'P': '76.7700000000',
                    'S': 0},
                    {'A': '0.6100000000',
                    'D': '1647000717267',
                    'I': '110163781755762116',
                    'P': '76.7700000000',
                    'S': 0},
                    {'A': '0.7900000000',
                    'D': '1647000698542',
                    'I': '110163781755762115',
                    'P': '76.7000000000',
                    'S': 0},
                    {'A': '1.1120000000',
                    'D': '1647000692670',
                    'I': '110163781755762114',
                    'P': '76.6900000000',
                    'S': 1},
                    {'A': '0.2880000000',
                    'D': '1647000692670',
                    'I': '110163781755762113',
                    'P': '76.6900000000',
                    'S': 1},
                    {'A': '1.4000000000',
                    'D': '1647000691575',
                    'I': '110163781755762112',
                    'P': '76.6900000000',
                    'S': 1},
                    {'A': '0.6100000000',
                    'D': '1647000687258',
                    'I': '110163781755762111',
                    'P': '76.7000000000',
                    'S': 1},
                    {'A': '1.5220000000',
                    'D': '1647000683927',
                    'I': '110163781755762110',
                    'P': '76.7900000000',
                    'S': 0},
                    {'A': '0.1479137526',
                    'D': '1647000676243',
                    'I': '110163781755762109',
                    'P': '76.8000000000',
                    'S': 0},
                    {'A': '6.8118144120',
                    'D': '1647000658838',
                    'I': '110163781755762108',
                    'P': '76.7900000000',
                    'S': 0},
                    {'A': '0.6758317902',
                    'D': '1647000652206',
                    'I': '110163781755762107',
                    'P': '76.8000000000',
                    'S': 0},
                    {'A': '1.9050000000',
                    'D': '1647000652206',
                    'I': '110163781755762106',
                    'P': '76.7600000000',
                    'S': 0},
                    {'A': '13.0294836890',
                    'D': '1647000635442',
                    'I': '110163781755762105',
                    'P': '76.6800000000',
                    'S': 0},
                    {'A': '4.0310000000',
                    'D': '1647000617276',
                    'I': '110163781755762104',
                    'P': '76.6900000000',
                    'S': 0},
                    {'A': '0.6490000000',
                    'D': '1647000617276',
                    'I': '110163781755762103',
                    'P': '76.6400000000',
                    'S': 0},
                    {'A': '0.2300000000',
                    'D': '1647000617276',
                    'I': '110163781755762102',
                    'P': '76.6100000000',
                    'S': 0},
                    {'A': '8.9211864350',
                    'D': '1647000607046',
                    'I': '110163781755762101',
                    'P': '76.6000000000',
                    'S': 1},
                    {'A': '4.7430000000',
                    'D': '1647000604304',
                    'I': '110163781755762100',
                    'P': '76.6000000000',
                    'S': 1},
                    {'A': '20.2258135650',
                    'D': '1647000592207',
                    'I': '110163781755762099',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '15.6691864350',
                    'D': '1647000563732',
                    'I': '110163781755762098',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '5.6740000000',
                    'D': '1647000563732',
                    'I': '110163781755762097',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '36.3078135650',
                    'D': '1647000563732',
                    'I': '110163781755762096',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '13.0430915049',
                    'D': '1647000530801',
                    'I': '110163781755762095',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '1.3000000000',
                    'D': '1647000502380',
                    'I': '110163781755762094',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '1.0427951658',
                    'D': '1647000488234',
                    'I': '110163781755762093',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '0.6472628686',
                    'D': '1647000440347',
                    'I': '110163781755762092',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '0.6860000000',
                    'D': '1647000440159',
                    'I': '110163781755762091',
                    'P': '76.4600000000',
                    'S': 1},
                    {'A': '5.7120000000',
                    'D': '1647000438093',
                    'I': '110163781755762090',
                    'P': '76.4000000000',
                    'S': 0},
                    {'A': '12.6370000000',
                    'D': '1647000437198',
                    'I': '110163781755762089',
                    'P': '76.3800000000',
                    'S': 0},
                    {'A': '0.5000000000',
                    'D': '1647000436516',
                    'I': '110163781755762088',
                    'P': '76.3700000000',
                    'S': 0},
                    {'A': '0.5000000000',
                    'D': '1647000428191',
                    'I': '110163781755762087',
                    'P': '76.2700000000',
                    'S': 1},
                    {'A': '2.0530000000',
                    'D': '1647000416314',
                    'I': '110163781755762086',
                    'P': '76.2600000000',
                    'S': 1},
                    {'A': '1.1900000000',
                    'D': '1647000415283',
                    'I': '110163781755762085',
                    'P': '76.3000000000',
                    'S': 0},
                    {'A': '39.2830000000',
                    'D': '1647000415283',
                    'I': '110163781755762084',
                    'P': '76.2900000000',
                    'S': 0},
                    {'A': '39.2830000000',
                    'D': '1647000405274',
                    'I': '110163781755762083',
                    'P': '76.2200000000',
                    'S': 0},
                    {'A': '0.8100000000',
                    'D': '1647000404137',
                    'I': '110163781755762082',
                    'P': '76.2100000000',
                    'S': 1},
                    {'A': '1.1900000000',
                    'D': '1647000404137',
                    'I': '110163781755762081',
                    'P': '76.2200000000',
                    'S': 1},
                    {'A': '1.0000000000',
                    'D': '1647000392549',
                    'I': '110163781755762080',
                    'P': '76.2000000000',
                    'S': 1},
                    {'A': '39.7500000000',
                    'D': '1647000319101',
                    'I': '110163781755762079',
                    'P': '76.2500000000',
                    'S': 1},
                    {'A': '0.7060000000',
                    'D': '1647000318677',
                    'I': '110163781755762078',
                    'P': '76.2500000000',
                    'S': 1},
                    {'A': '17.0980000000',
                    'D': '1647000311396',
                    'I': '110163781755762077',
                    'P': '76.2400000000',
                    'S': 1},
                    {'A': '0.6160000000',
                    'D': '1647000303913',
                    'I': '110163781755762076',
                    'P': '76.2500000000',
                    'S': 1},
                    {'A': '12.6370000000',
                    'D': '1647000303913',
                    'I': '110163781755762075',
                    'P': '76.2700000000',
                    'S': 1},
                    {'A': '0.6540000000',
                    'D': '1647000279134',
                    'I': '110163781755762074',
                    'P': '76.3500000000',
                    'S': 1},
                    {'A': '0.2096024805',
                    'D': '1647000258568',
                    'I': '110163781755762073',
                    'P': '76.6000000000',
                    'S': 0},
                    {'A': '0.2194344153',
                    'D': '1647000194305',
                    'I': '110163781755762072',
                    'P': '76.6000000000',
                    'S': 0}],
        'symbol': 'AVAXUSDT',
        'type': 421}]
        [422,
        {'A': '15.3700000000',
        'D': '1647000816026',
        'I': '110163781755762126',
        'P': '76.5900000000',
        'PS': 'AVAXUSDT',
        'S': 0,
        'channel': 'trade',
        'event': 'AVAXUSDT',
        'type': 422}]'''

        trade_update = {
            "e": "trade",
            "E": 1234567890123,
            "s": "COINALPHAHBOT",
            "t": 12345,
            "p": "0.001",
            "q": "100",
            "b": 88,
            "a": 50,
            "T": 123456785,
            "m": True,
            "M": True
        }

        trade_message = BtcturkOrderBook.trade_message_from_exchange(
            msg=trade_update,
            metadata={"trading_pair": "COINALPHA-HBOT"}
        )

        self.assertEqual("COINALPHA-HBOT", trade_message.trading_pair)
        self.assertEqual(OrderBookMessageType.TRADE, trade_message.type)
        self.assertEqual(1234567890.123, trade_message.timestamp)
        self.assertEqual(-1, trade_message.update_id)
        self.assertEqual(-1, trade_message.first_update_id)
        self.assertEqual(12345, trade_message.trade_id)
